---
layout: post
title: "MisskeyでMinioをS3ストレージとして使うときの設定メモ (11.30.0)"
date: "2019-12-21 14:05:00 +0900"
categories: 
  - blog
---
## 前書き

S3の設定をしようとしたがMinioの場合の設定のノウハウがあまり見つからなかったのでメモしておく  

Misskeyのバージョンはv11.30.0。v11の最初の頃はyamlで設定だった記述もあったが、  

このバージョンではWeb UIから設定可能となっている。  

## 環境

* misskeyが動作するホストとは別にMinioによるS3ストレージサーバーがある
* Minioのバケットの設定で `*` に `read` の権限がある

## 設定値
### URL

外から見えるURL。  

設定例 <a href="https://blob.example.com/mymisskey">https://blob.example.com/mymisskey  

### バケット名

Minioバケット名。そのままですね。  

このバケットを作ってくれるわけではないので事前にMinioのWeb UI等から作成する必要がある。  

### プレフィックス

指定したプレフィックスのディレクトリ（表現は正しくないですが）が作成される。  

オプションなので空欄でも良い。。 当方の設定は drive。  

### エンドポイント

Minioにアクセスする為のURL。 http(s)は付けない。（SSLを使用チェックボックスで決まる）  

ポート番号を指定することもできる。この記事はこの点をメモするために書いた。  

設定例 192.168.1.123:9000  

### リージョン

Minioであれば空欄でOK  

### ポート

エンドポイントに使用するポートだと思っていたが違うようだ。  

とりあえず、エンドポイントのポート番号を入れてある  

### アクセスキー/シークレットキー

Minioの起動時に表示されている値をそのまま入れれば良い  

